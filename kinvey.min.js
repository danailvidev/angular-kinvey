!function(){"use strict";angular.module("kinvey",["ngResource","ngCookies","base64"]).constant("$kinveyUrlComponents",{base:"https://baas.kinvey.com/",appdata:"appdata/",user:"user/",group:"group/",rpc:"rpc/",custom:"custom/",blob:"blob/",push:"push/"}).constant("$kinveyApiVersion",3).constant("$kinveyHeaders",{user:{"X-Kinvey-API-Version":"",Authorization:""},basic:{"X-Kinvey-API-Version":"",Authorization:""}}).provider("$kinvey",["$kinveyUrlComponents","$kinveyHeaders","$kinveyApiVersion","$base64",function(a,b,c,d){b.user["X-Kinvey-API-Version"]=c,b.basic["X-Kinvey-API-Version"]=c;var e;return{init:function(a){if(!a||!a.appKey||!a.appSecret)throw"$kinveyProvider.init requires an options object: {'appId':'YOUR APP ID','appSecret':'YOUR APP SECRET'}";e=a.appKey,b.user.Authorization=b.basic.Authorization="Basic "+d.encode(a.appKey+":"+a.appSecret)},$get:["$cookieStore","$resource","$http","$q",function(c,d,f,g){function h(a){return a&&a.document&&a.location&&a.alert&&a.setInterval}function i(a){return a&&a.$evalAsync&&a.$watch}function j(a,b){var c=b;if("string"==typeof a&&"$"===a.charAt(0)){var d=!1;angular.forEach(z,function(b){b==a&&(d=!0)}),d||(c=void 0)}else h(b)?c="$WINDOW":b&&document===b?c="$DOCUMENT":i(b)&&(c="$SCOPE");return c}function k(a,b){return"undefined"==typeof a?void 0:JSON.stringify(a,j,b?"  ":null)}function l(a,b){var c=g.defer(),d=b||{};return"$resolved"in d||(d.$resolved=!1),d.$promise=c.promise,a(d,c),d}function m(a,b,c){return function(d){var e=c?c(d):d;angular.extend(a,e),a.$resolved=!0,b.resolve(e)}}function n(a,b){return function(c){var d=b?b(c):c;a.reject(d)}}function o(a){angular.forEach(A,function(b){var c=a[b];a[b]=function(a,b,d,e){return a&&"query"in a&&(a.query=JSON.stringify(a.query)),c(a,b,d,e)}});var b=a.group;return a.group=function(a){return a.reduce&&(a.reduce=a.reduce.toString(),a.reduce=a.reduce.replace(/\n/g,""),a.reduce=a.reduce.replace(/\s/g,"")),b(a)},a}function p(a){return a.prototype.$download=function(){var a=this;return l(function(b,c){f(y.download(a)).then(m(b,c,r),n(c,r))})},a.prototype.$upload=function(a,b){var c=this;return l(function(d,e){f(y.upload(c,a,b)).then(m(d,e,r),n(e,r))})},a.prototype.$save=function(a){var b=this;return l(function(c,d){f(y.saveFile(b,a)).then(m(c,d,s),n(d,r))},b)},a.upload=function(a,b,c){return l(function(d,e){f(y.upload(a,b,c)).then(m(d,e,r),n(e,r))})},a.download=function(a){return l(function(b,c){f(y.download(a)).then(m(b,c,r),n(c,r))})},a.save=function(a,b){return l(function(c,d){f(y.saveFile(a,b)).then(m(c,d,s),n(d,r))},a)},a}function q(a){return a.save=function(a){return a._id?B.update(a):B.create(a)},a.prototype.$save=function(a){return a&&a._id&&!this._id&&(this._id=a._id),this._id?this.$update(a):this.$create(a)},a}function r(a){return a.data}function s(a){return new E(r(a))}function t(){return l(function(a,b){f(y.handshake()).then(m(a,b,r),n(b,r))})}function u(a,b){return l(function(c,d){f(y.rpc(a,b)).then(m(c,d,r),n(d,r))})}function v(a,b){if(a===b)throw"aliases must not attempt to overwrite $kinvey."+b}function w(a,b){v(b,"handshake"),v(b,"User"),v(b,"Group"),v(b,"Object"),v(b,"alias"),G[b]=B(a)}var x=c.get(e+":authToken");x&&(b.user.Authorization=x);var y={handshake:function(){return{method:"GET",url:a.base+a.appdata+e,headers:b.basic}},rpc:function(c,d){return{method:"POST",url:a.base+a.rpc+e+"/"+a.custom+c,headers:b.user,data:d}},upload:function(a,b,c){return{method:"PUT",url:a._uploadURL,data:b,headers:angular.extend({"Content-Type":c,Accept:void 0},a._requiredHeaders),transformRequest:angular.identity}},download:function(a){return{method:"GET",url:a._downloadURL}},saveFile:function(c,d){return{method:c._id?"PUT":"POST",url:a.base+a.blob+e+(c._id?"/"+c._id:""),headers:angular.extend({"X-Kinvey-Content-Type":d},b.user),data:c}}},z=["$gt","$gte","$in","$lt","$lte","$ne","$nin","$or","$and","$not","$nor","$exists","$type","$mod","$regex","$where","$geoWithin","$geoIntersects","$near","$nearSphere","$all","$elemMatch","$size","$","$elemMatch","$slice"],A=["query","delete"],B=function(c){return q(o(d(a.base+a.appdata+e+"/"+c+"/:_id",{_id:"@_id"},{create:{method:"POST",transformResponse:function(a){return new(B(c))(angular.fromJson(a))},headers:b.user,params:{_id:""}},get:{method:"GET",transformResponse:function(a){return new(B(c))(angular.fromJson(a))},headers:b.user},count:{method:"GET",headers:b.user,params:{_id:"_count"}},update:{method:"PUT",transformResponse:function(a){return new(B(c))(angular.fromJson(a))},headers:b.user},"delete":{method:"DELETE",headers:b.user},query:{method:"GET",transformResponse:function(a){var b=[],d=angular.fromJson(a);return angular.forEach(d,function(a){b.push(new(B(c))(a))}),b},headers:b.user,isArray:!0,params:{_id:""}},group:{method:"POST",headers:b.user,isArray:!0,params:{_id:"_group"},transformRequest:function(a){return k(a)}}})))},C=o(d(a.base+a.user+e+"/:_id",{_id:"@_id"},{login:{method:"POST",params:{_id:"login"},transformResponse:function(a){return a=angular.fromJson(a),a.error||(b.user.Authorization="Kinvey "+a._kmd.authtoken,c.put(e+":authToken","Kinvey "+a._kmd.authtoken)),new C(a)},headers:b.user},current:{method:"GET",params:{_id:"_me"},transformResponse:function(a){return new C(angular.fromJson(a))},headers:b.user},logout:{method:"POST",params:{_id:"_logout"},transformResponse:function(){b.user.Authorization=b.basic.Authorization,c.remove(e+":authToken")},headers:b.user},signup:{method:"POST",headers:b.basic,transformResponse:function(a){return a=angular.fromJson(a),a.error||(b.user.Authorization="Kinvey "+a._kmd.authtoken,c.put(e+":authToken","Kinvey "+a._kmd.authtoken)),new C(a)}},get:{method:"GET",transformResponse:function(a){return new C(angular.fromJson(a))},headers:b.user},lookup:{method:"POST",transformResponse:function(a){var b=[];return a=angular.fromJson(a),angular.forEach(a,function(a){b.push(new C(a))}),b},headers:b.user,isArray:!0,params:{_id:"_lookup"}},save:{method:"PUT",transformResponse:function(a){return new C(angular.fromJson(a))},headers:b.user},query:{method:"GET",transformResponse:function(a){var b=[];return a=angular.fromJson(a),angular.forEach(a,function(a){b.push(new C(a))}),b},headers:b.user,isArray:!0,params:{_id:""}},"delete":{method:"DELETE",params:{hard:!0},headers:b.user},suspend:{method:"DELETE",headers:b.user},verifyEmail:{method:"POST",headers:b.basic,url:a.base+a.rpc+e+"/:username:email/user-email-verification-initiate",params:{username:"@username",email:"@email"},transformRequest:function(){return""}},resetPassword:{method:"POST",headers:b.basic,url:a.base+a.rpc+e+"/:username:email/user-password-reset-initiate",params:{username:"@username",email:"@email"},transformRequest:function(){return""}},checkUsernameExists:{method:"POST",headers:b.basic,url:a.base+a.rpc+e+"/check-username-exists"}})),D=d(a.base+a.group+e+"/:_id",{_id:"@_id"},{get:{method:"GET",headers:b.user},save:{method:"PUT",headers:b.user},"delete":{method:"DELETE",headers:b.user}}),E=p(o(d(a.base+a.blob+e+"/:_id",{_id:"@_id"},{get:{method:"GET",headers:b.user,transformResponse:function(a){return new E(angular.fromJson(a))}},query:{method:"GET",headers:b.user,isArray:!0,params:{_id:""},transformResponse:function(a){var b=[];return angular.forEach(angular.fromJson(a),function(a){b.push(new E(a))}),b}},"delete":{method:"DELETE",headers:b.user}}))),F=d(a.base+a.push+e+"/:verb",{verb:"@verb"},{register:{method:"POST",headers:b.user,params:{verb:"register-device"}},unregister:{method:"POST",headers:b.user,params:{verb:"unregister-device"}}}),G={handshake:t,User:C,Group:D,Object:B,File:E,Push:F,alias:w,rpc:u};return G}]}}])}();