!function(){"use strict";angular.module("kinvey",["ngResource","ngCookies","ngBase64"]).provider("$kinvey",["$base64",function(a){function b(a){return a&&a.document&&a.location&&a.alert&&a.setInterval}function c(a){return a&&a.$evalAsync&&a.$watch}function d(a,d){var e=d;if("string"==typeof a&&"$"===a.charAt(0)){var f=!1;angular.forEach(p,function(b){b==a&&(f=!0)}),f||(e=void 0)}else b(d)?e="$WINDOW":d&&document===d?e="$DOCUMENT":c(d)&&(e="$SCOPE");return e}function e(a,b){return"undefined"==typeof a?void 0:JSON.stringify(a,d,b?"  ":null)}var f,g=3,h="https://baas.kinvey.com/",i="appdata/",j="user/",k="group/",l="rpc/",m="custom/",n="blob/",o={user:{"X-Kinvey-API-Version":g,Authorization:""},basic:{"X-Kinvey-API-Version":g,Authorization:""}},p=["$gt","$gte","$in","$lt","$lte","$ne","$nin","$or","$and","$not","$nor","$exists","$type","$mod","$regex","$where","$geoWithin","$geoIntersects","$near","$nearSphere","$all","$elemMatch","$size","$","$elemMatch","$slice"],q=["query","delete"];return{init:function(b){if(!b||!b.appKey||!b.appSecret)throw"$kinveyProvider.init requires an options object: {'appId':'YOUR APP ID','appSecret':'YOUR APP SECRET'}";f=b.appKey,o.user.Authorization=o.basic.Authorization="Basic "+a.encode(b.appKey+":"+b.appSecret)},$get:["$cookieStore","$resource","$http","$q",function(a,b,c,d){function g(a,b){var c=d.defer(),e=b||{$resolved:!1,$promise:c.promise};return a(e,c),e}function p(a,b,c){return function(d){var e=c?c(d):d;angular.extend(a,e),a.$resolved=!0,b.resolve(e)}}function r(a,b){return function(c){var d=b?b(c):c;a.reject(d)}}function s(a){angular.forEach(q,function(b){var c=a[b];a[b]=function(a,b,d,e){return a&&"query"in a&&(a.query=JSON.stringify(a.query)),c(a,b,d,e)}});var b=a.group;return a.group=function(a){return a.reduce&&(a.reduce=a.reduce.toString(),a.reduce=a.reduce.replace(/\n/g,""),a.reduce=a.reduce.replace(/\s/g,"")),b(a)},a}function t(a){return a.prototype.$download=function(){var a=this;return g(function(b,d){c(B.download(a)).then(p(b,d,u),r(d,u))})},a.prototype.$upload=function(a,b){var d=this;return g(function(e,f){c(B.upload(d,a,b)).then(p(e,f,u),r(f,u))})},a.prototype.$save=function(a){var b=this;return g(function(d,e){c(B.saveFile(b,a)).then(p(d,e,v),r(e,u))},b)},a.save=function(a,b){return g(function(d,e){c(B.saveFile(a,b)).then(p(d,e,v),r(e,u))},a)},a.upload=function(a,b,d){return g(function(e,f){c(B.upload(a,b,d)).then(p(e,f,u),r(f,u))})},a.download=function(a){return g(function(b,d){c(B.download(a)).then(p(b,d,u),r(d,u))})},a}function u(a){return a.data}function v(a){return new F(u(a))}function w(){return g(function(a,b){c(B.handshake()).then(p(a,b,u),r(b,u))})}function x(a,b){return g(function(d,e){c(B.rpc(a,b)).then(p(d,e,u),r(e,u))})}function y(a,b){if(a===b)throw"aliases must not attempt to overwrite $kinvey."+b}function z(a,b){y(b,"handshake"),y(b,"User"),y(b,"Group"),y(b,"Object"),y(b,"alias"),G[b]=C(a)}var A=a.get(f+":authToken");A&&(o.user.Authorization=A);var B={handshake:function(){return{method:"GET",url:h+i+f,headers:o.basic}},rpc:function(a,b){return{method:"POST",url:h+l+f+"/"+m+a,headers:o.user,data:b}},upload:function(a,b,c){return{method:"PUT",url:a._uploadURL,data:b,headers:angular.extend({"Content-Type":c,"Content-Length":b.length,Accept:void 0},a._requiredHeaders)}},download:function(a){return{method:"GET",url:a._downloadURL}},saveFile:function(a,b){return{method:a._id?"PUT":"POST",url:h+n+f+(a._id?"/"+a._id:""),headers:angular.extend({"X-Kinvey-Content-Type":b},o.user),data:a}}},C=function(a){return s(b(h+i+f+"/"+a+"/:_id",{_id:"@_id"},{create:{method:"POST",headers:o.user,params:{_id:""}},get:{method:"GET",headers:o.user},count:{method:"GET",headers:o.user,params:{_id:"_count"}},save:{method:"PUT",headers:o.user},"delete":{method:"DELETE",headers:o.user},query:{method:"GET",headers:o.user,isArray:!0,params:{_id:""}},group:{method:"POST",headers:o.user,isArray:!0,params:{_id:"_group"},transformRequest:function(a){return e(a)}}}))},D=s(b(h+j+f+"/:_id",{_id:"@_id"},{login:{method:"POST",params:{_id:"login"},transformResponse:function(b){return b=angular.fromJson(b),b.error||(o.user.Authorization="Kinvey "+b._kmd.authtoken,a.put(f+":authToken","Kinvey "+b._kmd.authtoken)),new D(b)},headers:o.user},current:{method:"GET",params:{_id:"_me"},headers:o.user},logout:{method:"POST",params:{_id:"_logout"},transformResponse:function(){o.user.Authorization=o.basic.Authorization,a.remove(f+":authToken")},headers:o.user},signup:{method:"POST",headers:o.basic,transformResponse:function(b){return b=angular.fromJson(b),b.error||(o.user.Authorization="Kinvey "+b._kmd.authtoken,a.put(f+":authToken","Kinvey "+b._kmd.authtoken)),new D(b)}},get:{method:"GET",headers:o.user},lookup:{method:"POST",headers:o.user,isArray:!0,params:{_id:"_lookup"}},save:{method:"PUT",headers:o.user},query:{method:"GET",headers:o.user,isArray:!0,params:{_id:""}},"delete":{method:"DELETE",params:{hard:!0},headers:o.user},suspend:{method:"DELETE",headers:o.user},verifyEmail:{method:"POST",headers:o.basic,url:h+l+f+"/:username:email/user-email-verification-initiate",params:{username:"@username",email:"@email"},transformRequest:function(){return""}},resetPassword:{method:"POST",headers:o.basic,url:h+l+f+"/:username:email/user-password-reset-initiate",params:{username:"@username",email:"@email"},transformRequest:function(){return""}},checkUsernameExists:{method:"POST",headers:o.basic,url:h+l+f+"/check-username-exists"}})),E=b(h+k+f+"/:_id",{_id:"@_id"},{get:{method:"GET",headers:o.user},save:{method:"PUT",headers:o.user},"delete":{method:"DELETE",headers:o.user}}),F=t(s(b(h+n+f+"/:_id",{_id:"@_id"},{get:{method:"GET",headers:o.user,transformResponse:function(a){return new F(angular.fromJson(a))}},query:{method:"GET",headers:o.user,isArray:!0,params:{_id:""},transformResponse:function(a){var b=[];return angular.forEach(angular.fromJson(a),function(a){b.push(new F(a))}),b}},"delete":{method:"DELETE",headers:o.user}}))),G={handshake:w,User:D,Group:E,Object:C,File:F,alias:z,rpc:x};return G}]}}])}();