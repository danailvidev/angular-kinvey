!function(){"use strict";angular.module("kinvey",["ngResource","ngCookies","base64"]).provider("$kinvey",["$base64",function(a){var b,c=3,d="https://baas.kinvey.com/",e="appdata/",f="user/",g="group/",h="rpc/",i="custom/",j="blob/",k="push/",l={user:{"X-Kinvey-API-Version":c,Authorization:""},basic:{"X-Kinvey-API-Version":c,Authorization:""}};return{init:function(c){if(!c||!c.appKey||!c.appSecret)throw"$kinveyProvider.init requires an options object: {'appId':'YOUR APP ID','appSecret':'YOUR APP SECRET'}";b=c.appKey,l.user.Authorization=l.basic.Authorization="Basic "+a.encode(c.appKey+":"+c.appSecret)},$get:["$cookieStore","$resource","$http","$q",function(a,c,m,n){function o(a){return a&&a.document&&a.location&&a.alert&&a.setInterval}function p(a){return a&&a.$evalAsync&&a.$watch}function q(a,b){var c=b;if("string"==typeof a&&"$"===a.charAt(0)){var d=!1;angular.forEach(G,function(b){b==a&&(d=!0)}),d||(c=void 0)}else o(b)?c="$WINDOW":b&&document===b?c="$DOCUMENT":p(b)&&(c="$SCOPE");return c}function r(a,b){return"undefined"==typeof a?void 0:JSON.stringify(a,q,b?"  ":null)}function s(a,b){var c=n.defer(),d=b||{};return"$resolved"in d||(d.$resolved=!1),d.$promise=c.promise,a(d,c),d}function t(a,b,c){return function(d){var e=c?c(d):d;angular.extend(a,e),a.$resolved=!0,b.resolve(e)}}function u(a,b){return function(c){var d=b?b(c):c;a.reject(d)}}function v(a){angular.forEach(H,function(b){var c=a[b];a[b]=function(a,b,d,e){return a&&"query"in a&&(a.query=JSON.stringify(a.query)),c(a,b,d,e)}});var b=a.group;return a.group=function(a){return a.reduce&&(a.reduce=a.reduce.toString(),a.reduce=a.reduce.replace(/\n/g,""),a.reduce=a.reduce.replace(/\s/g,"")),b(a)},a}function w(a){return a.prototype.$download=function(){var a=this;return s(function(b,c){m(F.download(a)).then(t(b,c,y),u(c,y))})},a.prototype.$upload=function(a,b){var c=this;return s(function(d,e){m(F.upload(c,a,b)).then(t(d,e,y),u(e,y))})},a.prototype.$save=function(a){var b=this;return s(function(c,d){m(F.saveFile(b,a)).then(t(c,d,z),u(d,y))},b)},a.upload=function(a,b,c){return s(function(d,e){m(F.upload(a,b,c)).then(t(d,e,y),u(e,y))})},a.download=function(a){return s(function(b,c){m(F.download(a)).then(t(b,c,y),u(c,y))})},a.save=function(a,b){return s(function(c,d){m(F.saveFile(a,b)).then(t(c,d,z),u(d,y))},a)},a}function x(a){return a.save=function(a){return a._id?I.update(a):I.create(a)},a.prototype.$save=function(a){return a&&a._id&&!this._id&&(this._id=a._id),this._id?this.$update(a):this.$create(a)},a}function y(a){return a.data}function z(a){return new L(y(a))}function A(){return s(function(a,b){m(F.handshake()).then(t(a,b,y),u(b,y))})}function B(a,b){return s(function(c,d){m(F.rpc(a,b)).then(t(c,d,y),u(d,y))})}function C(a,b){if(a===b)throw"aliases must not attempt to overwrite $kinvey."+b}function D(a,b){C(b,"handshake"),C(b,"User"),C(b,"Group"),C(b,"Object"),C(b,"alias"),N[b]=I(a)}var E=a.get(b+":authToken");E&&(l.user.Authorization=E);var F={handshake:function(){return{method:"GET",url:d+e+b,headers:l.basic}},rpc:function(a,c){return{method:"POST",url:d+h+b+"/"+i+a,headers:l.user,data:c}},upload:function(a,b,c){return{method:"PUT",url:a._uploadURL,data:b,headers:angular.extend({"Content-Type":c,Accept:void 0},a._requiredHeaders),transformRequest:angular.identity}},download:function(a){return{method:"GET",url:a._downloadURL}},saveFile:function(a,c){return{method:a._id?"PUT":"POST",url:d+j+b+(a._id?"/"+a._id:""),headers:angular.extend({"X-Kinvey-Content-Type":c},l.user),data:a}}},G=["$gt","$gte","$in","$lt","$lte","$ne","$nin","$or","$and","$not","$nor","$exists","$type","$mod","$regex","$where","$geoWithin","$geoIntersects","$near","$nearSphere","$all","$elemMatch","$size","$","$elemMatch","$slice"],H=["query","delete"],I=function(a){return x(v(c(d+e+b+"/"+a+"/:_id",{_id:"@_id"},{create:{method:"POST",transformResponse:function(b){return new(I(a))(angular.fromJson(b))},headers:l.user,params:{_id:""}},get:{method:"GET",transformResponse:function(b){return new(I(a))(angular.fromJson(b))},headers:l.user},count:{method:"GET",headers:l.user,params:{_id:"_count"}},update:{method:"PUT",transformResponse:function(b){return new(I(a))(angular.fromJson(b))},headers:l.user},"delete":{method:"DELETE",headers:l.user},query:{method:"GET",transformResponse:function(b){var c=[],d=angular.fromJson(b);return angular.forEach(d,function(b){c.push(new(I(a))(b))}),c},headers:l.user,isArray:!0,params:{_id:""}},group:{method:"POST",headers:l.user,isArray:!0,params:{_id:"_group"},transformRequest:function(a){return r(a)}}})))},J=v(c(d+f+b+"/:_id",{_id:"@_id"},{login:{method:"POST",params:{_id:"login"},transformResponse:function(c){return c=angular.fromJson(c),c.error||(l.user.Authorization="Kinvey "+c._kmd.authtoken,a.put(b+":authToken","Kinvey "+c._kmd.authtoken)),new J(c)},headers:l.user},current:{method:"GET",params:{_id:"_me"},transformResponse:function(a){return new J(angular.fromJson(a))},headers:l.user},logout:{method:"POST",params:{_id:"_logout"},transformResponse:function(){l.user.Authorization=l.basic.Authorization,a.remove(b+":authToken")},headers:l.user},signup:{method:"POST",headers:l.basic,transformResponse:function(c){return c=angular.fromJson(c),c.error||(l.user.Authorization="Kinvey "+c._kmd.authtoken,a.put(b+":authToken","Kinvey "+c._kmd.authtoken)),new J(c)}},get:{method:"GET",transformResponse:function(a){return new J(angular.fromJson(a))},headers:l.user},lookup:{method:"POST",transformResponse:function(a){var b=[];return a=angular.fromJson(a),angular.forEach(a,function(a){b.push(new J(a))}),b},headers:l.user,isArray:!0,params:{_id:"_lookup"}},save:{method:"PUT",transformResponse:function(a){return new J(angular.fromJson(a))},headers:l.user},query:{method:"GET",transformResponse:function(a){var b=[];return a=angular.fromJson(a),angular.forEach(a,function(a){b.push(new J(a))}),b},headers:l.user,isArray:!0,params:{_id:""}},"delete":{method:"DELETE",params:{hard:!0},headers:l.user},suspend:{method:"DELETE",headers:l.user},verifyEmail:{method:"POST",headers:l.basic,url:d+h+b+"/:username:email/user-email-verification-initiate",params:{username:"@username",email:"@email"},transformRequest:function(){return""}},resetPassword:{method:"POST",headers:l.basic,url:d+h+b+"/:username:email/user-password-reset-initiate",params:{username:"@username",email:"@email"},transformRequest:function(){return""}},checkUsernameExists:{method:"POST",headers:l.basic,url:d+h+b+"/check-username-exists"}})),K=c(d+g+b+"/:_id",{_id:"@_id"},{get:{method:"GET",headers:l.user},save:{method:"PUT",headers:l.user},"delete":{method:"DELETE",headers:l.user}}),L=w(v(c(d+j+b+"/:_id",{_id:"@_id"},{get:{method:"GET",headers:l.user,transformResponse:function(a){return new L(angular.fromJson(a))}},query:{method:"GET",headers:l.user,isArray:!0,params:{_id:""},transformResponse:function(a){var b=[];return angular.forEach(angular.fromJson(a),function(a){b.push(new L(a))}),b}},"delete":{method:"DELETE",headers:l.user}}))),M=c(d+k+b+"/:verb",{verb:"@verb"},{register:{method:"POST",headers:l.user,params:{verb:"register-device"}},unregister:{method:"POST",headers:l.user,params:{verb:"unregister-device"}}}),N={handshake:A,User:J,Group:K,Object:I,File:L,Push:M,alias:D,rpc:B};return N}]}}])}();