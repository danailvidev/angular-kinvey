!function(){"use strict";angular.module("ngKinvey",["ngResource","ngBase64"]).provider("$kinvey",["$base64",function(a){var b,c=3,d="https://baas.kinvey.com/",e="appdata/",f="user/",g="group/",h="rpc/",i={user:{"X-Kinvey-API-Version":c,Authorization:""},basic:{"X-Kinvey-API-Version":c,Authorization:""}};return{init:function(c){if(!c||!c.appKey||!c.appSecret)throw"$kinveyProvider.init requires an options object: {'appId':'YOUR APP ID','appSecret':'YOUR APP SECRET'}";b=c.appKey,i.user.Authorization=i.basic.Authorization="Basic "+a.encode(c.appKey+":"+c.appSecret)},$get:["$resource","$http","$q",function(a,c,j){function k(){var a=j.defer();return c.get(d+e+b,{headers:i.user}).then(function(b){a.resolve(b.data)},function(b){a.reject(b)}),a.promise}function l(c){return m(a(d+e+b+"/"+c+"/:_id",{_id:"@_id"},{create:{method:"POST",headers:i.user,params:{_id:""}},get:{method:"GET",headers:i.user},count:{method:"GET",headers:i.user,params:{_id:"_count"}},save:{method:"PUT",headers:i.user},"delete":{method:"DELETE",headers:i.user},query:{method:"GET",headers:i.user,isArray:!0,params:{_id:""}}}))}function m(a){return angular.forEach(s,function(b){var c=a[b];a[b]=function(a,b,d,e){return a.query&&(a.query=JSON.stringify(a.query)),c(a,b,d,e)}}),a}function n(a,b,c){return a[b]=c,a}function o(a,b){if(a===b)throw"aliases must not attempt to overwrite $kinvey."+b}function p(a,b){o(b,"handshake"),o(b,"User"),o(b,"Group"),o(b,"Object"),o(b,"alias"),t[b]=l(a)}var q=m(a(d+f+b+"/:_id",{_id:"@_id"},{login:{method:"POST",params:{_id:"login"},transformResponse:function(a){return a=angular.fromJson(a),a.error||(i.user.Authorization="Kinvey "+a._kmd.authtoken),new q(a)},headers:i.user},current:{method:"GET",params:{_id:"_me"},headers:i.user},logout:{method:"POST",params:{_id:"_logout"},transformResponse:function(){i.user.Authorization=i.basic.Authorization},headers:i.user},signup:{method:"POST",headers:i.basic,transformResponse:function(a){return a=angular.fromJson(a),a.error||(i.user.Authorization="Kinvey "+a._kmd.authtoken),new q(a)}},get:{method:"GET",headers:i.user},lookup:{method:"POST",headers:i.user,isArray:!0,params:{_id:"_lookup"}},save:{method:"PUT",headers:i.user},query:{method:"GET",headers:i.user,isArray:!0,params:{_id:""}},remove:{method:"DELETE",params:{hard:!0},headers:i.user},"delete":{method:"DELETE",params:{hard:!0},headers:i.user},suspend:{method:"DELETE",headers:i.user}}));n(q,"verifyEmail",function(a){return c.post(d+h+b+"/"+a+"/user-email-verification-initiate",{},{headers:i.basic})}),n(q,"resetPassword",function(a){return c.post(d+h+b+"/"+a+"/user-password-reset-initiate",{},{headers:i.basic})}),n(q,"checkUsernameExists",function(a){var e=j.defer();return c.post(d+h+b+"/check-username-exists",{username:a},{headers:i.basic}).then(function(a){e.resolve(a.data.usernameExists)},function(){e.reject()}),e.promise});var r=a(d+g+b+"/:_id",{_id:"@_id"},{get:{method:"GET",headers:i.user},save:{method:"PUT",headers:i.user},"delete":{method:"DELETE",headers:i.user}}),s=["query","delete"],t={handshake:k,User:q,Group:r,Object:l,alias:p};return t}]}}])}();